<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives | Tox Development blog</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="Perils of Tox development">
<meta property="og:type" content="website">
<meta property="og:title" content="Tox Development blog">
<meta property="og:url" content="https://blog.tox.im/archives/page/4/">
<meta property="og:site_name" content="Tox Development blog">
<meta property="og:description" content="Perils of Tox development">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tox Development blog">
<meta name="twitter:description" content="Perils of Tox development">

  
    <link rel="alternative" href="/atom.xml" title="Tox Development blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">Tox Development blog</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:https://blog.tox.im"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-apt-yum-repos-now-available-for-venom" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/08/01/apt-yum-repos-now-available-for-venom/" class="article-date">
  <time datetime="2014-08-01T07:39:21.000Z" itemprop="datePublished">Aug 1 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/08/01/apt-yum-repos-now-available-for-venom/">Apt &amp; Yum Repos Now Available for Venom</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>It’s been a long timesince we’ve starting packaging Venom builds as .deb and .rpm, but they never made it into their own repository’s. Today, that changes. For those of you who’ve wanted to install and update your Tox clients via your built-in package manager, your dream has come true.</p>
<h3 id="Apt/Aptitude_(Debian,_Ubuntu,_Mint,_etc-)">Apt/Aptitude (Debian, Ubuntu, Mint, etc.)</h3>
<p>If you want to set the repo up under Debian or any of its’ derivatives, simply run <code>wget https://repo.tox.im/tox-apt.sh &amp;&amp; sudo chmod +x ./tox-apt.sh &amp;&amp; ./tox-apt.sh</code> in your favorite terminal and then <code>apt-get install venom</code>.<br>If you want to update venom, simply run <code>apt-get update &amp;&amp; apt-get upgrade</code></p>
<h3 id="Yum_(Fedora,_CentOS,_RHEL,_etc-)">Yum (Fedora, CentOS, RHEL, etc.)</h3>
<p>Simply add <code>https://repo.tox.im/tox.repo</code> to your repo list, and then <code>yum install venom</code></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/qTox/">qTox</a>»<a class="article-category-link" href="/categories/qTox/Venom/">Venom</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post--ce-bctox-updates-0-1-0" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/07/29/-ce-bctox-updates-0-1-0/" class="article-date">
  <time datetime="2014-07-30T00:11:25.000Z" itemprop="datePublished">Jul 29 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/07/29/-ce-bctox-updates-0-1-0/">μTox updates [0.1.0]</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p><strong>New features:</strong></p>
<ul>
<li>Ability to start sending video (one way) during an audio call, or stop sending video during a video call</li>
<li>Playing 2 channel audio (note: uTox does not currently support sending 2 channel audio, only receiving)</li>
<li><p>These changes break compatibility with older clients<br><strong>Bugfixes:</strong></p>
</li>
<li><p>Windows XP fixes: uTox should now work on Windows XP</p>
</li>
<li>Audio playback fixes for Android</li>
<li>Fixed a number of segfaults/crashes (mostly Linux-exclusive)</li>
<li>Fixed flickering on Linux when resizing the window (<a href="https://github.com/notsecure/uTox/pull/175" target="_blank" rel="external">contribution by mk21</a>)</li>
<li><p>Fixed an issue with the red and blue channels being swapped on inline images<br><strong>Other:</strong></p>
</li>
<li><p>The uTox Updater for Windows has been updated and now has a GUI (the updater has a self update feature and should automatically update itself, please report any issues related to the updater)</p>
</li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/μTox/">μTox</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post--ce-bctox-updates-0-0-9" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/07/24/-ce-bctox-updates-0-0-9/" class="article-date">
  <time datetime="2014-07-24T17:46:51.000Z" itemprop="datePublished">Jul 24 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/07/24/-ce-bctox-updates-0-0-9/">μTox updates [0.0.9]</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>I will now be writing a blog post for every weekly μTox update, including a list of new features and bug fixes. This week’s update includes:</p>
<p><strong>New features:</strong></p>
<ul>
<li><p>Experimental Android support, includes audio calling. Get the .apk <a href="https://jenkins.libtoxcore.so/job/uTox_android/lastSuccessfulBuild/artifact/future.apk" target="_blank" rel="external">[here]</a><br><strong>Bugfixes:</strong></p>
</li>
<li><p>Fixed inline PNGs having red/blue channels swapped when saved</p>
</li>
<li><p>Shift+HOME/END in text boxes now behaves correctly<br><strong>Other:</strong></p>
</li>
<li><p>The core A/V protocol has changed: A/V is not compatible with older versions of uTox</p>
</li>
<li>Update 0.0.8 introduced a new major feature, allowing uTox users select a section of their desktop and send it as an inline image</li>
<li>Some people have been asking how the μTox updater for Windows works. You can read about how it works <a href="https://github.com/notsecure/utox-update" target="_blank" rel="external">[here]</a></li>
<li>Jenkins now builds 32-bit builds of uTox for Linux</li>
<li>uTox for Linux no longer relies on Xft, instead it uses Freetype directly</li>
<li>uTox for Linux now has a —version command</li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/μTox/">μTox</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-took-long-enough" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/07/12/took-long-enough/" class="article-date">
  <time datetime="2014-07-12T19:40:14.000Z" itemprop="datePublished">Jul 12 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/07/12/took-long-enough/">The day we&#39;ve all been waiting for</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Now that it’s <del>Friday</del> Saturday it’s finally time to spoil the news that we’ve somehow managed to keep mostly secret.</p>
<p>Tox is once and for all Alpha. Yes, you heard correctly, Alpha. That’s it, go home.</p>
<p>Kidding! We’ve got a <em>little bit more to share.</em></p>
<p>Right now when you want to download Tox you click on a button to a wiki page where you follow a confusing chart to find a bunch of builds for various clients, all squeezed together waiting for a click. You don’t know what’s better, you don’t know what does what, and that’s a serious issue.</p>
<p>First, we’ve introduced a single easy to use webpage. Those confusing charts? gone, just select your OS and be on your way. Remember all those clients when you went to past download Tox? The official client is now just Tox. We’ve gone ahead and chosen the best client for each OS and made it Tox. If you’re used to using builds of other clients or want to try something new don’t be disheartened, we’ll still be providing builds for all the clients so you can test to your hearts extent.</p>
<p>Having trouble with Tox? soon you’ll be able to go to our new support site, choose your issue, and have an answer. Still confused? You’ll also be able to punch in a question and get a response from a real live human as soon as we can. Say you find a bug, maybe you have a suggestion. Soon you’ll be able to make bug report for Tox, make a suggestion, or just tell us how you feel, and it’ll be sent to the respective support personnel and developers who’ll do what they can to see to it that your bug is resolved as soon as we can.</p>
<p>And what you’ve all been waiting for, Tox for Windows, OS X, and Linux all have calling, and Tox for Windows has video! Video should be arriving soon for OS X as it’s currently just broken due to a bug, and Linux is being worked on as we speak.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tox-Core/">Tox Core</a>»<a class="article-category-link" href="/categories/Tox-Core/Tox-Foundation/">Tox Foundation</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-tox-updates-kinda" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/07/08/tox-updates-kinda/" class="article-date">
  <time datetime="2014-07-08T07:03:36.000Z" itemprop="datePublished">Jul 8 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/07/08/tox-updates-kinda/">Tox Updates! Kinda</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Well folks, here we are, a blog post in what seems like forever.</p>
<p>Now, if you’re following the project off our blog and twitter, don’t get discouraged, we’re still alive and well, busily working away.</p>
<p>So, if you haven’t heard we introduced a site called <a href="https://toxme.se" title="https://toxme.se" target="_blank" rel="external">https://toxme.se</a>, a fast and easy way to share your ID with your friends. It’s as simple as punching in an ID, selecting a name, and getting a name like joe@toxme.se. Now I know what you may be wondering, isn’t this controlling in some sense? To correctly answer that we’ll have to look at how it works. The website is an extension of the DNS Discovery standard, a method for storing keys in DNS records, usually encrypted to prevent spoofing and mitm attacks. The way this works is that you can take your domain like cats.com and make your own sarah user, so all your friends can add you by adding sarah@cats.com, we’ve just gone ahead and setup a site to make it easy.</p>
<p>Now, toxme isn’t new, we introduced it a few weeks back, but never formally announced its arrival. If you signed up back then keep in mind, a few weeks back we did wipe all the records as we moved to an encrypted format, so your entry may no longer exist.</p>
<p>Now, I know what you’re thinking, that can’t be all they’ve done, right?</p>
<p>Right!, but we want to keep a good bit of it a surprise, so hold on to your horses for a few more days, this is going to be big.</p>
<p>Happy Toxxing,</p>
<p>Sean</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tox-Core/">Tox Core</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-new-milestone-reached-audio-calling-on-windows" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/05/31/new-milestone-reached-audio-calling-on-windows/" class="article-date">
  <time datetime="2014-05-31T19:41:45.000Z" itemprop="datePublished">May 31 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/05/31/new-milestone-reached-audio-calling-on-windows/">New Milestone Reached: Audio Calling on Windows</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Yesterday a new milestone was reached, winTox (Windows only GUI) now supports audio calling. winTox is the first non command line client and the first Windows client to support audio calling.</p>
<p>To try it out just grab one of the latest winTox builds from: <a href="https://wiki.tox.im/Binaries" target="_blank" rel="external">https://wiki.tox.im/Binaries</a></p>
<p>Make sure your friend has a client that supports audio calling (only toxic and winTox do at the moment) then click on your friend and press the call button near the top right corner or accept the incoming call with the same button.</p>
<p>The audio calling part of Tox currently uses the opus codec at 64kbs for 1 channel 48khz audio. It is encrypted exactly the same way as everything else (text, files, etc..) with xsalsa20 + poly1305 and a temporary key but unlike text and audio it is sent as a lossy packet for minimum delay and because some packet loss in audio transmissions is acceptable.</p>
<p>Note that Tox and all its clients are still in alpha state so if you encounter any bugs or issues let us know and we will fix them.</p>
<p>winTox github repo: <a href="https://github.com/notsecure/winTox" target="_blank" rel="external">https://github.com/notsecure/winTox</a></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Google-Summer-of-Code/">Google Summer of Code</a>»<a class="article-category-link" href="/categories/Google-Summer-of-Code/Tox-Core/">Tox Core</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-the-tcp-branch-an-explanation" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/05/20/the-tcp-branch-an-explanation/" class="article-date">
  <time datetime="2014-05-20T19:21:56.000Z" itemprop="datePublished">May 20 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/05/20/the-tcp-branch-an-explanation/">The TCP branch: An Explanation</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>The TCP branch was merged 2 days ago breaking all compatibility with older clients, yesterday, a major protocol change was introduced, if you run a bootstrap node or a client with a core version older than <a href="https://github.com/irungentoo/ProjectTox-Core/commit/e85feb8a3db42a0285b940a090c60102fae50374" target="_blank" rel="external">https://github.com/irungentoo/ProjectTox-Core/commit/e85feb8a3db42a0285b940a090c60102fae50374</a> then please update it.</p>
<p>So, what does the TCP branch bring to Tox?</p>
<p>Tox now supports using TCP relay nodes to connect to friends meaning those behind unpunchable NATs should now be able to connect.</p>
<p>The protocol has been revamped to be better and safer. Packets are now generally smaller in size and the protocol used to transport the data securely has been redesigned in order to prevent possible evil relays from interfering with the connections between you and your friends. The protocol also now supports padding which can be used to obscure the size of the data transmitted.</p>
<p>Tox can switch between relayed TCP and direct UDP connections seamlessly meaning if you initially connect to a friend with a TCP relay and then for some reason 5 minutes later the hole punching works and the direct UDP starts working Tox will automatically switch from one to the other without the users noticing anything.</p>
<p>This also means that Tox can switch between different relays if one used to connect to the other peer goes offline. Again, without the users noticing anything.</p>
<p>There have also been some fixes and optimizations to increase the initial connection speed meaning you should see your friends come online faster than before.</p>
<p>I will warn you though that group chats and A/V have not yet been updated to work with the TCP so issues with them right now are perfectly normal.</p>
<p>If you try Tox but can’t connect to anyone make sure you are using an updated core and bootstrapping into the network with an updated node, (<a href="https://wiki.tox.im/Nodes" target="_blank" rel="external">https://wiki.tox.im/Nodes</a>)</p>
<p>In other news Google Summer of Code has officially started which means the amount of work done on Tox will increase.</p>
<p>This update brings us closer to our goal of creating the best skype replacement that works everywhere while being both secure and simple to use.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tox-Core/">Tox Core</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-tcp-branch-merged-with-master" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/05/18/tcp-branch-merged-with-master/" class="article-date">
  <time datetime="2014-05-19T00:00:16.000Z" itemprop="datePublished">May 18 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/05/18/tcp-branch-merged-with-master/">TCP Branch Merged with Master</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>irungentoo has merged the TCP branch he has been long working on today, which now enabled those behind restrictive NATs access to TCP relays in order to connect with other users. Most of the changes were backend, which means not much is required to update existing clients, but be aware that old clients will no longer work with new clients.</p>
<p>Expect a detailed post about all the changes soon.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tox-Core/">Tox Core</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-were-not-dead-just-working-on-tcp" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/05/04/were-not-dead-just-working-on-tcp/" class="article-date">
  <time datetime="2014-05-04T22:09:18.000Z" itemprop="datePublished">May 4 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/05/04/were-not-dead-just-working-on-tcp/">We&#39;re Not Dead; Just Working on TCP</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Just for those who may be worried that there haven’t been any commits to the master branch in a few days, irungentoo and others are all making commits to the TCP branch of the GitHub repository. You can view our progress <a href="https://github.com/irungentoo/ProjectTox-Core/tree/TCP" target="_blank" rel="external">here.</a></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tox-Core/">Tox Core</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
    <article id="post-how-the-crypto-tox-uses-works" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2014/04/27/how-the-crypto-tox-uses-works/" class="article-date">
  <time datetime="2014-04-27T20:06:36.000Z" itemprop="datePublished">Apr 27 2014</time>
</a>
		</span>
		<span class="meta-elements author">Tox Foundation</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2014/04/27/how-the-crypto-tox-uses-works/">How the crypto Tox uses works</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Yesterday, I made this: <a href="https://gist.github.com/irungentoo/58a8b5da5b2becd09e0f" target="_blank" rel="external">https://gist.github.com/irungentoo/58a8b5da5b2becd09e0f</a></p>
<p>If this is the first time you see this puzzle and want to try solving it then stop reading this now.</p>
<p>I was very disappointed that only one anonymous person seemed to know how to solve it so I’m writing this to educate you on how the crypto Tox uses to encrypt messages works.</p>
<p>First of all, the flaw in the secure_chat.py program in the puzzle is that nonces are reused for every message. If every message had a different nonce this puzzle would be unsolvable.</p>
<p>I’ll start by explaining how crypto_box in NaCl works before telling you the solution.</p>
<p>crypto_box_keypair(pk,sk) generates a Curve25519 public/private keypair for us. crypto_box_beforenm(k,pk,sk) then uses our secret key and the other guys public key to generate a key using ECDH (Elliptic curve Diffie-Hellman)</p>
<p>The other guy also uses it on his side and gets the same key as us.</p>
<p>So both now have the same 256bit key that only they know.</p>
<p>what do they do with that key? they use it to encrypt/decrypt data using xsalsa20: a stream cipher.</p>
<p>How does a stream cipher work?</p>
<p>You have a function to generate a stream of pseudorandom bytes based on a nonce and a key: crypto_stream(c,clen,n,k)</p>
<p>To encrypt a message, just generate a stream as long as the message then XOR the message with the stream.</p>
<p>Since the stream looks random, the stream xored with the message will also appear to be random.</p>
<p>To decrypt the message, just use the same nonce and key to generate a stream then xor the stream with the encrypted message to get the message.</p>
<p>Now, this is nice and all but how do we protect ourselves against someone modifying the message? Or someone trying to send us fake messages?</p>
<p>That’s where the MAC (message authentication code) Poly1305 comes in.</p>
<p>MACs are used to authenticate messages, by verifying them, the receiver</p>
<p>crypto_onetimeauth(a,m,mlen,k) Is used to generate a 16 byte authenticator that is appended to the beginning of each plaintext message encrypted with crypto_box right before being actually encrypted.</p>
<p>Poly1305 requires that the key given to it is always different so it takes the first 32bytes that comes out of crypto_stream(c,clen,n,k) (clen is always 32 + 16 (the length of the MAC) + msglen) for that key.</p>
<p>So, it generates an xsalsa20 stream 48 bytes longer than the message, takes the first 32 to generate the 16 byte MAC, appends it to the beginning of the message and encrypts the MAC+Message with the rest of the generated stream bytes.</p>
<p>So how do we solve the puzzle?</p>
<p>nonces are reused which means the stream generated by crypto_stream(c,clen,n,k) is the same for all messages.</p>
<p>The first two packets are obviously the handshake (size checks out).</p>
<p>This particular python wrapper puts the 24 byte nonce at the beginning of each encrypted message and we know the handshake.</p>
<p>So we just xor the plaintext handshake with where the message is in the encrypted message to get the stream.</p>
<p>With the stream we can then decrypt all the packets that use that same nonce by xoring the stream with the encrypted message.</p>
<p>Repeat that for the packets with the other nonce and we can decrypt everything.</p>
<p>Easy right?</p>
<p>This is why every single message must be encrypted with a different nonce, so that a different stream is used for each message.</p>
<p>Further reading:<br><a href="http://nacl.cr.yp.to/box.html" target="_blank" rel="external">http://nacl.cr.yp.to/box.html</a><br><a href="http://nacl.cr.yp.to/stream.html" target="_blank" rel="external">http://nacl.cr.yp.to/stream.html</a><br><a href="http://nacl.cr.yp.to/onetimeauth.html" target="_blank" rel="external">http://nacl.cr.yp.to/onetimeauth.html</a><br><a href="https://en.wikipedia.org/wiki/Curve25519" target="_blank" rel="external">https://en.wikipedia.org/wiki/Curve25519</a><br><a href="https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman" target="_blank" rel="external">https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman</a><br><a href="https://en.wikipedia.org/wiki/Poly1305-AES" target="_blank" rel="external">https://en.wikipedia.org/wiki/Poly1305-AES</a></p>
<p><a href="https://en.wikipedia.org/wiki/Cryptographic_nonce" target="_blank" rel="external">https://en.wikipedia.org/wiki/Cryptographic_nonce</a></p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tox-Core/">Tox Core</a>
  </div>

			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">




  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/archives/page/3/">&laquo; Prev</a><a class="page-number" href="/archives/">1</a><a class="page-number" href="/archives/page/2/">2</a><a class="page-number" href="/archives/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/archives/page/5/">5</a><a class="page-number" href="/archives/page/6/">6</a><a class="page-number" href="/archives/page/7/">7</a><a class="extend next" rel="next" href="/archives/page/5/">Next &raquo;</a>
    </nav>
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:blog.tox.im">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">Tox Development blog</a>
	</h1>
	<span class="copyright">
		&copy; 2015 Tox Foundation<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>